# ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏≠‡∏ö‡∏ï.‡∏´‡∏±‡∏ß‡∏ô‡∏≤

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏≥‡∏ö‡∏•‡∏´‡∏±‡∏ß‡∏ô‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏î‡§∂‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Telegram

## ‚ú® Features

- üì± **Progressive Web App (PWA)** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
- ‚è∞ **‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô** ‡∏ú‡πà‡∏≤‡∏ô LINE LIFF
- üìç **‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á GPS** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
- üë• **‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
- üìä **‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel** - ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
- üîî **‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Telegram** - ‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
- ü§ñ **‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥** - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏•‡∏∑‡∏°‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å
- üõ°Ô∏è **‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô** - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏°‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô
- üíæ **Google Sheets Integration** - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets

## üèóÔ∏è Tech Stack

- **Backend:** Node.js, Express.js
- **Frontend:** HTML5, CSS3, JavaScript (Vanilla)
- **Database:** Google Sheets API
- **Authentication:** JWT
- **Notifications:** Telegram Bot API
- **Maps:** OpenStreetMap Nominatim API
- **Export:** ExcelJS
- **Deployment:** Render.com

## üìã Prerequisites

1. **Google Cloud Project** ‡∏û‡∏£‡πâ‡∏≠‡∏° Service Account
2. **Google Sheets** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
3. **Telegram Bot** (optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)
4. **LINE Developers Account** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö LIFF
5. **Render.com Account** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö deployment

## üöÄ Quick Start

### 1. Clone Repository

```bash
git clone <repository-url>
cd newtime_tracker
```

### 2. Install Dependencies

```bash
npm install
```

### 3. Environment Setup

```bash
cp .env.example .env
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô .env ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
```

### 4. Google Sheets Setup

```bash
node setup-telegram-sheet.js
```

### 5. Run Development Server

```bash
npm start
# ‡∏´‡∏£‡∏∑‡∏≠
node server.js
```

## üìä Google Sheets Structure

‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ Google Sheets 4 ‡πÅ‡∏ú‡πà‡∏ô:

1. **MAIN** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
2. **EMPLOYEES** - ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
3. **ON_WORK** - ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
4. **TELEGRAM_SETTINGS** - ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

## üîî Telegram Settings

‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô 3 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:

- **clock_in_out** - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å
- **missed_checkout** - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏•‡∏∑‡∏°‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å
- **system_alerts** - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

## üõ†Ô∏è Deployment

### Render.com Deployment

1. **Fork repository** ‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub account ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

2. **‡∏™‡∏£‡πâ‡∏≤‡∏á Web Service ‡πÉ‡∏ô Render.com**
   - Connect GitHub repository
   - Build Command: `npm install`
   - Start Command: `npm start`

3. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables**
   ```
   GOOGLE_SPREADSHEET_ID=your_spreadsheet_id
   GOOGLE_PRIVATE_KEY=your_private_key
   GOOGLE_CLIENT_EMAIL=your_service_account_email
   LIFF_ID=your_liff_id
   JWT_SECRET=your_jwt_secret
   RENDER_SERVICE_URL=https://your-app.onrender.com
   KEEP_ALIVE_ENABLED=true
   NODE_ENV=production
   ```

### Other Deployment Options

- **Heroku**
- **Railway**
- **Vercel**
- **Self-hosted VPS**

## üì± Admin Panel

‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏µ‡πà: `https://your-domain.com/admin`

**Default Admin Account:**
- Username: `admin`
- Password: `khayai042315962`

### Admin Features

- üìä **Dashboard** - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
- üë• **‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô** - ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
- üìà **‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å** - Excel reports
- ‚öôÔ∏è **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö** - Emergency mode, cache management

## üîß Configuration

### üì± Telegram Notifications (Fast Mode)

‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Telegram ‡πÅ‡∏ö‡∏ö `.env` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î:

```bash
# ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å
TELEGRAM_CLOCK_IN_OUT_ENABLED=true
TELEGRAM_CLOCK_IN_OUT_BOT_TOKEN=your_bot_token
TELEGRAM_CLOCK_IN_OUT_CHAT_ID=your_chat_id

# ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡∏•‡∏∑‡∏°‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å)
TELEGRAM_SYSTEM_ALERT_ENABLED=true
TELEGRAM_SYSTEM_ALERT_BOT_TOKEN=your_bot_token
TELEGRAM_SYSTEM_ALERT_CHAT_ID=your_chat_id
```

**Notification Types:**
- `clock_in_out` - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å
- `system_alert` - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (‡∏•‡∏∑‡∏°‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å)
- `forgot_clock` - ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏•‡∏∑‡∏°‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤

### Auto Checkout Settings

```javascript
AUTO_CHECKOUT: {
  EXEMPT_EMPLOYEES: [
    '1017-‡πÄ‡∏õ‡∏£‡∏°‡∏ä‡∏±‡∏¢ ‡∏ó‡∏≠‡∏á‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°' // ‡∏¢‡∏≤‡∏°‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô
  ],
  CUTOFF_HOUR: 23,
  CUTOFF_MINUTE: 59
}
```

### Cache Settings

- **EMPLOYEES**: 10 minutes
- **ON_WORK**: 1 minute
- **MAIN**: 30 seconds
- **STATS**: 2 minutes
- **TELEGRAM_SETTINGS**: 5 minutes

## üîí Security

- JWT Authentication ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin Panel
- Rate limiting ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API calls
- Input validation ‡πÅ‡∏•‡∏∞ sanitization
- CORS configuration
- Environment variables ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sensitive data

## üìù API Endpoints

### Public API
- `POST /clock-in` - ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô
- `POST /clock-out` - ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏á‡∏≤‡∏ô
- `GET /employee-status/:name` - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
- `GET /employees` - ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô

### Admin API (Authentication Required)
- `GET /api/admin/stats` - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏∞‡∏ö‡∏ö
- `GET /api/admin/export/:type` - ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- `GET /api/admin/telegram-settings` - ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Telegram
- `PUT /api/admin/telegram-settings/:id` - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
- `POST /api/admin/telegram-settings/test` - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

## üêõ Troubleshooting

### Common Issues

1. **Google Sheets API Quota Exceeded**
   - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ cache ‡πÅ‡∏•‡∏∞ emergency mode
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API usage ‡πÉ‡∏ô Google Cloud Console

2. **Telegram Notifications Not Working**
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Bot Token ‡πÅ‡∏•‡∏∞ Chat ID
   - ‡πÉ‡∏ä‡πâ test function ‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î admin

3. **Excel Export Errors**
   - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö memory limits
   - ‡∏•‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å

## üìû Support

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:
- üìß Email: [your-email]
- üí¨ LINE: [your-line-id]

## üìÑ License

This project is licensed under the MIT License.

## üôè Acknowledgments

- Google Sheets API
- Telegram Bot API
- OpenStreetMap Nominatim
- ExcelJS Library
- Moment.js
